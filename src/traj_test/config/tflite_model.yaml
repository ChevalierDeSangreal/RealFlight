# TFLite Neural Network Model Configuration for Trajectory Test
# This configuration file specifies the neural network model and control parameters

/**:
  ros__parameters:
    # Neural network control
    use_neural_control: true
    
    # Model path (relative to package share directory or absolute path)
    # You may need to adjust this path based on your installation
    model_path: "/home/carlson/wangzimo/realflight_ws/src/traj_test/config/trackVer8_policy_stable.tflite"
    
    # Control timing
    timer_period: 0.01  # 100 Hz control loop (matches model dt=0.01)
    hover_duration: 5.0  # Duration to run trajectory control [seconds] (+ 1s wait = 4s total)
    
    # Fallback hover parameters (used if neural control fails)
    hover_thrust: 0.71  # Normalized thrust for hovering [0.0-1.0]
    
    # Target position/trajectory (in NED frame, meters)
    # Target is 1m in front of drone at GOTO position [-1.5, 0.0, -1.5]
    # Drone faces north (yaw=0), so target is along +X direction
    target_x: -0.5  # -1.5 + 1.0 = -0.5 (1m forward from drone)
    target_y: 0.0   # No lateral offset
    target_z: -1.5  # Same altitude as drone (NED: negative = above ground)
    
    # Target velocity (optional, for tracking moving targets)
    target_vx: 0.0
    target_vy: 0.0
    target_vz: 0.0
    
# Notes:
# - The model expects observations at 100 Hz (dt=0.01s)
# - Action repeat (10 steps) is handled internally in the TFLitePolicyInference class
# - Model input: 130D = 10 history steps Ã— (4 action dims + 9 obs dims) per step
#   - Buffer format: [action_t-9, obs_t-9, action_t-8, obs_t-8, ..., action_t, obs_t]
# - Model output: 4D [thrust, omega_x, omega_y, omega_z]
# - All outputs are in range [-1, 1] due to tanh activation
# - Observation space (9D, body frame):
#   - Body velocity (3), Body gravity direction (3), Body target position (3)

